---
title:  "íƒ€ì´íƒ€ë‹‰ ë°ì´í„° ì…‹ì˜ íŒŒìƒë³€ìˆ˜ ë§Œë“¤ê¸°, One-Hot-Encoding, ê²°ì¸¡ì¹˜ ëŒ€ì²´, ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ ì ìš©"
excerpt: "íƒ€ì´íƒ€ë‹‰ ë°ì´í„° ì…‹ì˜ ë¨¸ì‹ ëŸ¬ë‹ ì—°ìŠµ."

categories:
  - Blog
tags:
  - Blog
last_modified_at: 2022-11-03T08:06:00-05:00
---



# 0503(11/01)ì—ì„œ ì´ì–´ì§

ìƒì„±í•œ íŒŒìƒë³€ìˆ˜ê°€ Trainê³¼ Testì— ë™ì¼í•˜ê²Œ ìˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ set ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.

```python
# trainì—ë§Œ ìˆëŠ” í˜¸ì¹­ì„ í™•ì¸í•˜ê¸° ìœ„í•œ ì½”ë“œ
set(train["Title"].unique()) - set(test["Title"].unique())

ê²°ê³¼ê°’ :
{'Capt',
 'Don',
 'Jonkheer',
 'Lady',
 'Major',
 'Mlle',
 'Mme',
 'Sir',
 'the Countess'}
```

```python
# testì—ë§Œ ìˆëŠ” í˜¸ì„ í™•ì¸í•˜ê¸° ìœ„í•œ ì½”ë“œ
set(test["Title"].unique()) - set(train["Title"].unique())

ê²°ê³¼ê°’ : {'Dona'}
```

í™•ì¸í•œ ê²°ê³¼ ê½¤ ë§ì€ ì°¨ì´ê°€ ìƒê¸°ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ë‹¤. ê·¸ëŸ¬ë©´, ì°¨ì´ì˜ ìˆ«ìê°€ ì–¼ë§ˆë‚˜ ìˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ê°ê° `value_counts()`ë¥¼ í†µí•´ì„œ í™•ì¸í•´ë³´ì.

```python
train["Title"].value_counts()

ê²°ê³¼ê°’ :
Mr              517
Miss            182
Mrs             125
Master           40
Dr                7
Rev               6
Mlle              2
Major             2
Col               2
the Countess      1
Capt              1
Ms                1
Sir               1
Lady              1
Mme               1
Don               1
Jonkheer          1
Name: Title, dtype: int64
```

```python
test["Title"].value_counts()

ê²°ê³¼ê°’ : 
Mr        240
Miss       78
Mrs        72
Master     21
Col         2
Rev         2
Ms          1
Dr          1
Dona        1
Name: Title, dtype: int64
```

train setì„ ë³´ë©´ 2ê°œ ì´í•˜ì¸ ë³€ìˆ˜ëª…ì´ ì—¬ëŸ¬ ì¡´ì¬í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì „ì²˜ë¦¬ë¥¼ ìœ„í•´ 2ê°œ ì´í•˜(2ê°œë‚˜ 1ê°œë§Œ ìˆëŠ” í˜¸ì¹­)ëŠ” Etcë¡œ ë¬¶ì–´ì£¼ë„ë¡ í•œë‹¤. ë°ì´í„° ì „ì²˜ë¦¬ë¥¼ í•  ë•ŒëŠ” trainì„ ê¸°ì¤€ìœ¼ë¡œ í•œë‹¤. (í˜„ì‹¤ ì„¸ê³„ì—ì„œ test ëŠ” ì•„ì§ ëª¨ë¥´ëŠ” ë°ì´í„°ì´ê¸° ë•Œë¬¸ì—)

```python
title_count = train["Title"].value_counts()
not_etc = title_count[title_count > 2].index

# ~ : 'í•´ë‹¹ ë‚´ìš©ì„ ì œì™¸í•œ' ì´ë¼ëŠ” ì˜ë¯¸ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ì¦‰, trian.locì•ˆì— ë‹´ê²¨ì§„ í–‰ì€ not_etcì—
#     í¬í•¨ë˜ì§€ ì•Šì€ í–‰ì„ Etcë¡œ ë°”ê¿”ë‹¬ë¼ëŠ” ì½”ë“œì´ë‹¤.
train["TitleEtc"] = train["Title"]
train.loc[~train["Title"].isin(not_etc), "TitleEtc"] = "Etc"

# ì£¼í”¼í„° ë…¸íŠ¸ë¶ì—ì„  ESC + Fë¥¼ ëˆ„ë¥´ë©´ Find and Replaceê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
test["TitleEtc"] = test["Title"]
test.loc[~train["Title"].isin(not_etc), "TitleEtc"] = "Etc"
```

`Cabin`ë„ ì•ê¸€ìë§Œ ë”°ì™€ì„œ `Cabin_initial`ì´ë¼ëŠ” ì»¬ëŸ¼ì— ë‹´ì•„ë‘ë„ë¡ í•œë‹¤.

```python
train["Cabin_Initial"] = train["Cabin"].astype(str).map(lambda x : x[:1].upper().strip())
test["Cabin_Initial"] = test["Cabin"].astype(str).map(lambda x : x[:1].upper().strip())

# ê°•ì‚¬ë‹˜ í•´ì„¤

train["Cabin_Initial"] = train["Cabin"]
train["Cabin_Initial"] = train["Cabin_initial"].fillna("N").str[0]

test["Cabin_Initial"] = test["Cabin"]
test["Cabin_Initial"] = test["Cabin_initial"].fillna("N").str[0]
```

train í…Œì´ë¸”ê³¼ test í…Œì´ë¸”ì´ ê°™ì€ ê°’ì„ ê°€ì¡ŒëŠ”ì§€ë¥¼ í™•ì¸í•´ë³´ì.

```python
train["Cabin_Initial"].value_counts()

ê²°ê³¼ê°’ : 
N    687
C     59
B     47
D     33
E     32
A     15
F     13
G      4
T      1
Name: Cabin_Initial, dtype: int64

test["Cabin_Initial"].value_counts()

ê²°ê³¼ê°’ : 
N    327
C     35
B     18
D     13
E      9
F      8
A      7
G      1
Name: Cabin_Initial, dtype: int64
```

í™•ì¸ ê²°ê³¼, test í…Œì´ë¸”ì—ëŠ” trainì˜ â€œTâ€ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ, Tê°’ì´ í•˜ë‚˜ë§Œ ìˆê¸° ë•Œë¬¸ì— fareì˜ í‰ê· ê°’ì„ êµ¬í•œ ë’¤, ê°€ì¥ ê·¼ì ‘í•œ `Cabin_Initial`ë¡œ ëŒ€ì²´í•˜ë„ë¡ í•˜ì.

```python
# Cabin_Initial Columnsì˜ í‰ê·  Fareê°’ì„ êµ¬í•˜ê¸° ìœ„í•œ ì½”ë“œ. Groupbyë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•˜ì.
train.groupby(["Cabin_Initial"])["Fare"].mean()

ê²°ê³¼ê°’ : 
Cabin_Initial
A     39.623887
B    113.505764
C    100.151341
D     57.244576
E     46.026694
F     18.696792
G     13.581250
N     19.157325
T     35.500000
Name: Fare, dtype: float64
```

í™•ì¸í•œ ê²°ê³¼, Aì™€ ê°€ì¥ ê·¼ì ‘í•˜ê¸° ë•Œë¬¸ì— Të¥¼ Aë¡œ ëŒ€ì²´í•´ì£¼ê³  ê°’ì´ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤.

```python
# replace ê¸°ëŠ¥ì„ ì´ìš©í•˜ì—¬ Të¥¼ Aë¡œ ëŒ€ì²´í•œë‹¤.
train["Cabin_Initial"] = train["Cabin_Initial"].replace("T", "A")

# ì •ìƒì ìœ¼ë¡œ ê°’ì´ ì˜ ì…ë ¥ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì. ì •ìƒì ìœ¼ë¡œ ì…ë ¥ì´ ë˜ì—ˆë‹¤ë©´, ê° í…Œì´ë¸”ì˜ nunique
# ê°’ì´ ë™ì¼í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ê³ , setì„ ì´ìš©í•˜ì—¬ ì°¨ì´ë¥¼ êµ¬í•˜ë©´ ë‚¨ëŠ” uniqueê°€ ì—†ì„ ê²ƒì´ë‹¤.
print(train["Cabin_Initial"].nunique(), test["Cabin_Initial"].nunique())
set(train["Cabin_Initial"].unique()) - set(test["Cabin_Initial"].unique())

ê²°ê³¼ê°’ : 

8 8
set()
```

## One-Hot-Encoding

í•œ ê°œì˜ columns ì•ˆì— ë“¤ì–´ìˆëŠ” ë³€ìˆ˜ê°€ ë¶„ë¥˜í˜•ì´ë©´ ëª¨ë¸ì´ í•™ìŠµí•  ë•Œ ë¬¸ìëŠ” ì¸ì‹ì„ í•˜ì§€ ëª»í•´ì„œ í•™ìŠµí•  ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ê·¸ëŸ¬í•œ ë¶„ë¥˜í˜• ë³€ìˆ˜ë“¤ì„ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ê³¼ì • ì¤‘ í•˜ë‚˜ê°€ One-Hot-Encodingì´ë‹¤. One-Hot-Encodingì˜ ì‘ë™ ì›ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.

```python
# One-Hop-Encodingì´ ë™ì‘í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

train["Embarked_S"] =train["Embarked"] == "S"
train["Embarked_C"] =train["Embarked"] == "C"
train["Embarked_Q"] =train["Embarked"] == "Q"

train[["Embarked", "Embarked_S", "Embarked_C", "Embarked_Q"]].head(2)
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8611d893-6147-48dd-b433-79e2577048f6/Untitled.png)

`Embarked` ì»¬ëŸ¼ ì•ˆì˜ ë³€ìˆ˜ (S, C, Q)ë¥¼ ê°ê° ìƒˆë¡œìš´ ì»¬ëŸ¼(Embarked_S, Embarked_C, Embarked_Q)ìœ¼ë¡œ ë§Œë“¤ì–´ í•´ë‹¹ ì»¬ëŸ¼ì´ í•´ë‹¹ ë³€ìˆ˜(Embarked_S = S)ê°€ ìˆìœ¼ë©´ True, ì—†ìœ¼ë©´ Falseë¡œ í‘œê¸°í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ë‹¤. 

```python
test["Embarked_S"] =test["Embarked"] == "S"
test["Embarked_C"] =test["Embarked"] == "C"
test["Embarked_Q"] =test["Embarked"] == "Q"

train[["Embarked", "Embarked_S", "Embarked_C", "Embarked_Q"]].head(2)
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/624b5aec-74e9-4313-ac91-2d34e7570d2d/Untitled.png)

### [pd.get_dummies](https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html)

One-Hot-Encodingì„ íŒë‹¤ìŠ¤ì—ì„œ ì§€ì›í•˜ëŠ” ì½”ë“œì´ë‹¤. ë˜í•œ, ì¸ì½”ë”©ëœ ë°ì´í„°ì˜ íƒ€ì…ì€ objectì´ë‹¤.

```python
s = pd.Series(list('abca'))
pd.get_dummies(s)

ê²°ê³¼ê°’ : 
   a  b  c
0  1  0  0
1  0  1  0
2  0  0  1
3  1  0  0
```

<aside>
âš ï¸ trainì—ë§Œ ë“±ì¥í•˜ëŠ” í˜¸ì¹­ì€ í•™ìŠµì„ í•´ë„ testì— ì—†ê¸° ë•Œë¬¸ì— ì˜ˆì¸¡ì— í° ë„ì›€ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. train ì—ë§Œ ë“±ì¥í•˜ëŠ” í˜¸ì¹­ì„ í”¼ì²˜ë¡œ ë§Œë“¤ì–´ ì£¼ê²Œ ë˜ë©´ í”¼ì²˜ì˜ ê°œìˆ˜ê°€ ëŠ˜ì–´ë‚˜ëŠ”ë° ë¶ˆí•„ìš”í•œ í”¼ì²˜ê°€ ìƒê¸°ê¸°ë„ í•˜ê³  ë°ì´í„°ì˜ í¬ê¸°ë„ ì»¤ì§€ê¸° ë•Œë¬¸ì— í•™ìŠµì—ë„ ì‹œê°„ì´ ë” ê±¸ë¦½ë‹ˆë‹¤. ë„ˆë¬´ ì ê²Œ ë“±ì¥í•˜ëŠ” ê°’ì„ í”¼ì²˜ë¡œ ë§Œë“¤ì—ˆì„ ë•Œ í•´ë‹¹ ê°’ì— ëŒ€í•œ ì˜¤ë²„í”¼íŒ… ë¬¸ì œë„ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. trainê³¼ testì˜ í”¼ì²˜ ê°œìˆ˜ê°€ ë‹¤ë¥´ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤

ì›í•«ì¸ì½”ë”©ì„ í•  ë•Œ train, testí”¼ì²˜ì˜ ê°œìˆ˜ì™€ ì¢…ë¥˜ê°€ ê°™ì€ì§€ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ trainí”¼ì²˜ëŠ” ìˆ˜í•™ì¸ë°, testí”¼ì²˜ëŠ” êµ­ì–´ë¼ê³  í•˜ë©´ í”¼ì²˜ì˜ ê°œìˆ˜ê°€ ê°™ë”ë¼ë„ ë‹¤ë¥¸ ì¢…ë¥˜ ê°’ì´ê¸° ë–„ë¬¸ì— ì œëŒ€ë¡œ í•™ìŠµí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í”¼ì²˜ë¥¼ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ë§Œë“¤ ë–¼ë„ ì œëŒ€ë¡œ ë§Œë“¤ì–´ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.

</aside>

## ê²°ì¸¡ì¹˜ ëŒ€ì²´

train tableì— `â€œAgeâ€`ì™€ test tableì˜ `â€œAgeâ€`,`â€Fareâ€`ì— ê²°ì¸¡ì¹˜ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ê²°ì¸¡ì¹˜ë¥¼ ì±„ìš°ë„ë¡ í•œë‹¤. ê²°ì¸¡ì¹˜ë¥¼ ì±„ìš°ëŠ” ì´ìœ ëŠ” ê²°ì¸¡ì¹˜ê°€ ì¡´ì¬í•˜ë©´ ë¨¸ì‹ ëŸ¬ë‹ì„ ì§„í–‰í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤. ì±„ì›Œì§€ëŠ” ê²°ì¸¡ì¹˜ ê°’ì€ ìƒí™©ì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•˜ê²Œ ì¤‘ì•™ê°’(`median()`)ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ê² ë‹¤.

<aside>
âš ï¸ í˜„ì‹¤ì„¸ê³„ì—ì„œ ë¶„ì„í•˜ëŠ” ë°ì´í„°ëŠ” í•¨ë¶€ë¡œ ê²°ì¸¡ì¹˜ë¥¼ ì±„ìš°ëŠ” ê²ƒì— ì£¼ì˜ë¥¼ í•´ì•¼í•œë‹¤. ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•Šê²Œ í•˜ê¸° ìœ„í•´ ê²°ì¸¡ì¹˜ë¥¼ ì±„ìš´ ê²ƒì´ë¼ ë¶„ì„í•  ë•Œë„ ì±„ìš´ë‹¤ê³  ì˜¤í•´í•˜ë©´ ì•ˆëœë‹¤.

</aside>

```python
# train columnì— ê²°ì¸¡ì¹˜ê°€ ì±„ì›Œì§ˆ Age_fill ì»¬ëŸ¼ì„ Age ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ í•´ì„œ ì¶”ê°€ ìƒì„±.
train["Age_fill"] = train["Age"]

# ì¤‘ì•™ê°’ ì‚¬ìš©
train["Age_fill"] = train["Age_fill"].fillna(train["Age"].median())

# trainê³¼ ë§ˆì°¬ê°€ì§€ë¡œ testì—ì„œë„ ë™ì¼í•˜ê²Œ ì§„í–‰í•œë‹¤.
# testì—ì„œëŠ” Fareì—ì„œë„ ê²°ì¸¡ê°’ì´ ìˆê¸° ë•Œë¬¸ì— ê°™ì´ ì§„í–‰í•œë‹¤.
test["Age_fill"] = test["Age"]
test["Fare_fill"] = test["Fare"]

#ì¤‘ì•™ê°’ ì‚¬ìš©
test["Age_fill"] = test["Age_fill"].fillna(test["Age"].median()) 
test["Fare_fill"] = test["Fare_fill"].fillna(test["Fare"].median())

# trainê³¼ testì˜ columnsê°€ ì¼ì¹˜í•´ì•¼ ë¨¸ì‹ ëŸ¬ë‹ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— 
# trainì˜ fareì— ê²°ì¸¡ì¹˜ê°€ ì—†ë”ë¼ë„ ë™ì¼í•œ columnì„ ìƒì„±í•´ì£¼ì.

train["Fare_fill"] = train["Fare"]
```

## í•™ìŠµì— ì‚¬ìš©ë  ê°’ ì§€ì •

label_nameê³¼ feature_namesì— ì˜ˆì¸¡í•  ì»¬ëŸ¼ê³¼ ì‚¬ìš©í•  ì»¬ëŸ¼ì„ ì§€ì •í•œë‹¤.

```python
# label_name ì´ë¼ëŠ” ë³€ìˆ˜ì— ì˜ˆì¸¡í•  ì»¬ëŸ¼ì˜ ì´ë¦„ì„ ë‹´ì•„ì£¼ì.
label_name = "Survived"

# feature_namesì—ëŠ” ì „ì²˜ë¦¬í•œ columnsë¥¼ ë‹´ì•„ì£¼ì.
feature_names = ['Pclass','Embarked', 
                 'FamilySize', 'Gender','TitleEtc', 'Cabin_Initial',
                 'Age_fill', 'Fare_fill']
```

ëª¨ë¸ì— ì‚¬ìš©ë  X tableì€ `get_dummies`ë¥¼ ì´ìš©í•´ì„œ ë§Œë“¤ì–´ì¤€ë‹¤.

```python
X_train = pd.get_dummies(train[feature_names])
X_test = pd.get_dummies(test[feature_names])

# ì»¬ëŸ¼ë“¤ì´ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•´ì£¼ì.
set(X_train.columns) - set(X_test.columns)

ê²°ê³¼ê°’ : 0
```

## ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ ê°€ì ¸ì˜¤ê¸°

ê°„ë‹¨í•˜ê²Œ í™•ì¸í•˜ê¸° ìœ„í•´ ê²°ì • íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•´ë³´ê¸°ë¡œ í•˜ì˜€ë‹¤.

```python
from sklearn.tree import DecisionTreeClassifier

model = DecisionTreeClassifier(random_state=42)
```

```python
from sklearn.model_selection import cross_val_score, cross_val_predict

y_valid_predict = cross_val_predict(model, X_train, y_train, cv=5, n_jobs=-1, verbose=1)
y_valid_predict[:5]
```

## ì •í™•ë„ ì˜ˆì¸¡í•˜ê¸°

```python
(y_valid_predict == y_train).mean()

ê²°ê³¼ê°’ : 0.7665544332210998
```

## í•™ìŠµ (í›ˆë ¨)

```python
model.fit(X_train, y_train)
y_predict = model.predict(X_test)
```

í”¼ì €ì˜ ì¤‘ìš”ë„ë„ ì‹œê°í™” í•´ë³´ì

```python
sns.barplot(x = model.feature_importances_, y = model.feature_names_in_)
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/78175ff4-4ec5-49a7-a06a-1dbe90442f18/Untitled.png)

## ì˜ˆì¸¡

```python
# valid_accuracy : ì—¬ëŸ¬ë²ˆ ëª¨ë¸ì„ ìˆ˜ì •í•˜ê³  ì œì¶œí•˜ë‹¤ë³´ë©´ valid ì ìˆ˜ì™€ ì‹¤ì œ ìºê¸€ì— ì œì¶œí•œ ì ìˆ˜ë¥¼ 
#                  ë¹„êµí•˜ê¸° ì‰½ê²Œ í•˜ê¸° ìœ„í•´ ì œì¶œ íŒŒì¼ì´ë¦„ì— valid scoreë¥¼ ì ì–´ì£¼ë©´ 
#                  ìºê¸€ ì ìˆ˜ì™€ ë¹„êµí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.

valid_accuracy = (y_train == y_valid_predict).mean()
valid_accuracy

ê²°ê³¼ê°’ : 0.7665544332210998
```

## ì˜ˆì¸¡í•œ ê°’ì„ ì¼€ê¸€ì— ì œì¶œ

ì œì¶œì— ì‚¬ìš©í•  data setì„ ë¶ˆëŸ¬ì˜¨ë‹¤

```python
submit = pd.read_csv("data/titanic/gender_submission.csv", index_col = "PassengerId")
```

ì œì¶œí•  submitì˜ â€œSurvivedâ€ ì»¬ëŸ¼ì— ì˜ˆì¸¡í•œ ê°’ì„ ì§‘ì–´ë„£ëŠ”ë‹¤.

```python
submit['Survived'] = y_predict
```

ë°˜ë³µì ì¸ íŒŒì¼ì €ì¥ê³¼ ì¦ì€ íŒŒë¼ë¯¸í„° ë³€ê²½ìœ¼ë¡œ ë°”ë€ ì ìˆ˜ë¥¼ ì¼ê´„ì ìœ¼ë¡œ ì €ì¥í•´ì£¼ëŠ” ëª…ë ¹ì–´ë¥¼ ë„£ì–´ì£¼ê³  íŒŒì¼ì„ ìƒì„±í•œë‹¤.

```python
file_name = f"data/titanic/submit_{vaild_accuracy:.5f}.csv"

submit.to_csv(file_name)
```

ìƒì„±ëœ íŒŒì¼ì„ ìºê¸€ì— ì œì¶œí•œë‹¤(11/01 ê¸€ì— ì •ë¦¬ë˜ì–´ìˆìŒ)

<aside>
âš ï¸ **íƒ€ì´íƒ€ë‹‰ ê²½ì§„ëŒ€íšŒ ê´€ë ¨ ë‚´ìš©**

íƒ€ì´íƒ€ë‹‰ ëŒ€íšŒëŠ” ì›Œë‚™ ìœ ëª…í•œ ëŒ€íšŒë¼ì„œ ì¹˜íŒ…ë„ ë§ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ 1ì ì— ê°€ê¹Œìš´ ì ìˆ˜ëŠ” ê±°ì˜ ì¹˜íŒ…ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 200ìœ„ ê·¼ì²˜ì˜ ì ìˆ˜ë¥¼ ë³´ë©´ 0.82~0.81 ì •ë„ê°€ ìˆëŠ”ë° ì´ì •ë„ê°€ ë¨¸ì‹ ëŸ¬ë‹ì˜ ë‹¤ì–‘í•œ ê¸°ë²•ì„ ì‚¬ìš©í•´ì„œ í’€ì–´ë³¼ ìˆ˜ ìˆëŠ” í˜„ì‹¤ì ì¸  ìŠ¤ì½”ì–´ êµ¬ê°„ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

</aside>

<aside>
ğŸ’¡ **ìºê¸€ì—ì„œ ì¢‹ì€ ì†”ë£¨ì…˜ ì°¾ëŠ” ë²•**

1) Top í‚¤ì›Œë“œë¡œ ê²€ìƒ‰
2) ì†”ë£¨ì…˜ì— ëŒ€í•œ íˆ¬í‘œìˆ˜ê°€ ë§ì€ ê²ƒ
3) í”„ë¡œí•„ ë©”ë‹¬ì˜ ìƒ‰ìƒ

</aside>

# 0504

## ê²°ì¸¡ì¹˜ ëŒ€ì²´

`[interpolate`](https://pandas.pydata.org/docs/reference/api/pandas.Series.interpolate.html?highlight=interpolate) : ë³´ê°„ë²• ì¤‘ í•˜ë‚˜. íŠ¹ì • ì¡°ê±´ì— ë”°ë¼ì„œ ê²°ì¸¡ì¹˜ë¥¼ ì±„ìš°ëŠ” ëª…ë ¹ì–´. fillna() ì™€ ë¹„ìŠ·í•œ ì—­í• ì„ í•˜ë‚˜ ê²°ì¸¡ì¹˜ë¥¼ ì–´ë–»ê²Œ ì±„ìš¸ ê²ƒì¸ì§€ë¥¼ ë”°ë¡œ ì„¤ì •ì„ í•´ì¤„ ìˆ˜ ìˆë‹¤.

<aside>
ğŸ’¡ ì´ì „ ê°’ì´ë‚˜ ë‹¤ìŒ ê°’ìœ¼ë¡œ ì±„ìš¸ ìˆ˜ ìˆëŠ”ë° ì´ëŸ° ë°©ë²•ì€ ëŒ€ë¶€ë¶„ ì‹œê³„ì—´ë°ì´í„°ì—ì„œ ë°ì´í„°ê°€ ìˆœì„œëŒ€ë¡œ ìˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì¼ìë³„ ì£¼ê°€ ë°ì´í„°ê°€ ìˆë‹¤ê³  ê°€ì •í•  ë•Œ ì¤‘ê°„ì— ë¹ ì§„ ë‚ ì§œì— ëŒ€í•œ ë°ì´í„°ë¥¼ ì±„ìš¸ ë•Œ ì‚¬ìš©í•˜ê±°ë‚˜ ì˜ˆë¥¼ ë“¤ì–´ ìˆœì„œê°€ ìˆëŠ” ì„¼ì„œ ë°ì´í„°ì—ì„œ ìˆ˜ì§‘ì´ ëˆ„ë½ë˜ì—ˆê±°ë‚˜ í•  ë•Œ ì•,ë’¤ ê°’ì— ì˜í–¥ì„ ë°›ëŠ” ë°ì´í„°ë¥¼ ì±„ìš¸ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

ê·¸ëŸ°ë° ì—¬ê¸°ì—ì„œëŠ” ë°ì´í„°ê°€ ìˆœì„œëŒ€ë¡œ ìˆë‹¤ëŠ” ë³´ì¥ì€ ì—†ì§€ë§Œ ì´ë ‡ê²Œ ì±„ìš¸ìˆ˜ë„ ìˆë‹¤ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

</aside>

```python
# fillna
# method : {'backfill', 'bfill', 'pad', 'ffill', None},
#  Method to use for filling holes in reindexed Series
#     pad / ffill: propagate last valid observation forward to next valid
#     backfill / bfill: use next valid observation to fill gap.

# interpolate
# limit_direction : {{'forward', 'backward', 'both'}}
# both ë¡œ ì§€ì •í•˜ë©´ ìœ„ ì•„ë˜ ê²°ì¸¡ì¹˜ë¥¼ ëª¨ë‘ ì±„ì›Œì£¼ê³  ë‚˜ë¨¸ì§€ëŠ” ì±„ìš¸ ë°©í–¥ì„ ì„¤ì •í•©ë‹ˆë‹¤.

train["Age_ffill"] = train["Age"].fillna(method="ffill")
train["Age_bfill"] = train["Age"].fillna(method="bfill")
train["Age_interpolate"] = train["Age"].interpolate(method='linear', limit_direction='both')
train[["Age", "Age_ffill", "Age_bfill", "Age_interpolate"]].tail()
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/25ee1367-1166-4bdd-ab06-b6257c55bc05/Untitled.png)

ë§ˆì°¬ê°€ì§€ë¡œ test í…Œì´ë¸”ë„ ì±„ìš°ë„ë¡ í•œë‹¤.

```python
test["Age_ffill"] = test["Age"].fillna(method="ffill")
test["Age_bfill"] = test["Age"].fillna(method="bfill")
test["Age_interpolate"] = test["Age"].interpolate(method='linear', limit_direction='both')
```

## ì •ë‹µê°’, ì˜ˆì¸¡ê°’, ì„¤ì • ë° í•™ìŠµ/ì˜ˆì¸¡ ë°ì´í„° ì…‹ ë§Œë“¤ê¸°

```python
# ì˜ˆì¸¡í•  ê°’ì¸ Survivedë¥¼ label_nameì— ë‹´ì•„ë‘”ë‹¤.
label_name = "Survived"

# ì „ì²˜ë¦¬í•œ columnsë¥¼ feature_namesì— ë‹´ì•„ë‘”ë‹¤.
feature_names = ["Pclass", "Sex", "Age_interpolate", "Fare_fill", "Embarked"]

# X, y ë°ì´í„° ì…‹ì„ ë§Œë“ ë‹¤.
X_train = pd.get_dummies(train[feature_names])
X_test = pd.get_dummies(test[feature_names])

y_train = train[label_name]
```

## ****ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ ê°€ì ¸ì˜¤ê¸°****

ëœë¤ í¬ë ˆìŠ¤íŠ¸ë¥¼ ì´ìš©í•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ì„ í˜¸ì¶œí•œë‹¤.

```python
from sklearn.ensemble import RandomForestClassifier

RandomForestClassifier(n_estimators=100, random_state=42, n_jobs = -1)
```

<aside>
ğŸ’¡ **ëœë¤ í¬ë ˆìŠ¤íŠ¸ì— ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” íŒŒë¼ë¯¸í„°**

n_estimators : íŠ¸ë¦¬ì˜ ìˆ˜
criterion: ê°€ì§€ì˜ ë¶„í• ì˜ í’ˆì§ˆì„ ì¸¡ì •í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.
max_depth: íŠ¸ë¦¬ì˜ ìµœëŒ€ ê¹Šì´ì…ë‹ˆë‹¤.
min_samples_split:ë‚´ë¶€ ë…¸ë“œë¥¼ ë¶„í• í•˜ëŠ” ë° í•„ìš”í•œ ìµœì†Œ ìƒ˜í”Œ ìˆ˜ì…ë‹ˆë‹¤.
min_samples_leaf: ë¦¬í”„ ë…¸ë“œì— ìˆì–´ì•¼ í•˜ëŠ” ìµœì†Œ ìƒ˜í”Œ ìˆ˜ì…ë‹ˆë‹¤.
max_leaf_nodes: ë¦¬í”„ ë…¸ë“œ ìˆ«ìì˜ ì œí•œì¹˜ì…ë‹ˆë‹¤.
random_state: ì¶”ì •ê¸°ì˜ ë¬´ì‘ìœ„ì„±ì„ ì œì–´í•©ë‹ˆë‹¤. ì‹¤í–‰í–ˆì„ ë•Œ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ë„ë¡ í•©ë‹ˆë‹¤.

</aside>